<mah:MetroWindow x:Class="SwiftOpsToolbox.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SwiftOpsToolbox"
        xmlns:views="clr-namespace:SwiftOpsToolbox.Views"
        mc:Ignorable="d"
        Title="SwiftOps Toolbox" Height="600" Width="900"
        WindowStartupLocation="Manual"
        Background="#0F0F10">

    <Window.Resources>
        <!-- New Color Palette -->
        <SolidColorBrush x:Key="ElectricBlue" Color="#007BFF" />
        <SolidColorBrush x:Key="VibrantOrange" Color="#FF6F00" />
        <SolidColorBrush x:Key="DarkGray" Color="#333333" />
        <SolidColorBrush x:Key="LightGray" Color="#F5F5F5" />
        <SolidColorBrush x:Key="White" Color="#FFFFFF" />
        
        <!-- Dark theme resources (updated with new palette) -->
        <SolidColorBrush x:Key="SurfaceBrush" Color="#0F0F10" />
        <SolidColorBrush x:Key="PanelBrush" Color="#161616" />
        <SolidColorBrush x:Key="AccentBrush" Color="#007BFF" />
        <SolidColorBrush x:Key="MutedText" Color="#A6A6A6" />

        <!-- Simple card style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="#141416" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="12" />
            <Setter Property="BorderBrush" Value="#222" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="SnapsToDevicePixels" Value="True" />
        </Style>

        <!-- Large calendar style: adjusted for dark theme and removed aggressive scaling -->
        <Style x:Key="LargeCalendarStyle" TargetType="Calendar">
            <!-- Remove LayoutTransform scaling which made calendars oversized/clipped -->
            <!--<Setter Property="LayoutTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="2" ScaleY="2" />
                </Setter.Value>
            </Setter>-->
            <Setter Property="Margin" Value="8" />
            <Setter Property="Background" Value="#141416" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush" Value="#222" />
            <Setter Property="BorderThickness" Value="1" />
            <!-- Make header and day names more readable -->
            <Setter Property="FontSize" Value="13" />
        </Style>

        <!-- Small calendar style for 3-month view -->
        <Style x:Key="SmallCalendarStyle" TargetType="Calendar">
            <!--<Setter Property="LayoutTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1" />
                </Setter.Value>
            </Setter>-->
            <Setter Property="Width" Value="220" />
            <Setter Property="Height" Value="200" />
            <Setter Property="Margin" Value="6" />
            <Setter Property="Background" Value="#141416" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderBrush" Value="#222" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="FontSize" Value="12" />
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="120" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Vertical left nav (compact) -->
        <DockPanel Grid.Column="0" Background="{StaticResource DarkGray}">
            <StackPanel VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="6">
                <Button x:Name="BtnTasks" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="88" Height="88" Margin="6" ToolTip="Home">
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="20" Text="&#xE80F;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <TextBlock Text="Home" Foreground="White" Opacity="0.95" FontSize="11" HorizontalAlignment="Center" Margin="0,6,0,0" />
                    </StackPanel>
                </Button>

                <Button x:Name="BtnCalendar" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="88" Height="88" Margin="6" ToolTip="Calendar">
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="20" Text="&#xE787;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <TextBlock Text="Calendar" Foreground="White" Opacity="0.95" FontSize="11" HorizontalAlignment="Center" Margin="0,6,0,0" />
                    </StackPanel>
                </Button>

                <Button x:Name="BtnClipboard" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="88" Height="88" Margin="6" ToolTip="Clipboard">
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="20" Text="&#xE8C8;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <TextBlock Text="Clipboard" Foreground="White" Opacity="0.95" FontSize="11" HorizontalAlignment="Center" Margin="0,6,0,0" />
                    </StackPanel>
                </Button>

                <Button x:Name="BtnNotepad" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="88" Height="88" Margin="6" ToolTip="Notepad">
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="20" Text="&#xE8A5;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <TextBlock Text="Notepad" Foreground="White" Opacity="0.95" FontSize="11" HorizontalAlignment="Center" Margin="0,6,0,0" />
                    </StackPanel>
                </Button>

                <Button x:Name="BtnSearch" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="88" Height="88" Margin="6" ToolTip="Search">
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="20" Text="&#xE8B7;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <TextBlock Text="Search" Foreground="White" Opacity="0.95" FontSize="11" HorizontalAlignment="Center" Margin="0,6,0,0" />
                    </StackPanel>
                </Button>

                <Button x:Name="BtnSettings" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="88" Height="88" Margin="6" ToolTip="Settings">
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                        <TextBlock FontFamily="Segoe MDL2 Assets" FontSize="20" Text="&#xE713;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                        <TextBlock Text="Settings" Foreground="White" Opacity="0.95" FontSize="11" HorizontalAlignment="Center" Margin="0,6,0,0" />
                    </StackPanel>
                </Button>
            </StackPanel>
        </DockPanel>

        <!-- Main area -->
        <Grid Grid.Column="1" Margin="12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Top bar -->
            <Grid Grid.Row="0" Height="48" Margin="132,0,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="200" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center"/>
            </Grid>

            <!-- Content split -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition x:Name="LeftColumn" Width="3*" />
                    <ColumnDefinition x:Name="RightColumn" Width="2*" />
                </Grid.ColumnDefinitions>

                <!-- Left area root: holds four mode panels (calendar, tasks, clipboard, notepad) -->
                <Grid Grid.Column="0">

                    <!-- Home panel -->
                    <Grid x:Name="HomePanel" Visibility="Visible">
                        <Border Style="{StaticResource CardStyle}">
                            <StackPanel>
                                <TextBlock Text="Welcome to SwiftOps Toolbox" Foreground="White" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,8" />
                                <TextBlock Text="Quick overview" Foreground="{StaticResource MutedText}" Margin="0,0,0,12" />

                                <!-- Status / summary for toolbox -->
                                <Border Background="#0F0F10" BorderBrush="#222" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,12">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="200" />
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Orientation="Vertical">
                                            <TextBlock Text="Current status" Foreground="White" FontSize="14" FontWeight="SemiBold" />
                                            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                <TextBlock Text="Time: " Foreground="{StaticResource MutedText}" Width="80" />
                                                <TextBlock Text="{Binding CurrentTime}" Foreground="White" />
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                <TextBlock Text="Weather: " Foreground="{StaticResource MutedText}" Width="80" />
                                                <TextBlock Text="{Binding WeatherText}" Foreground="White" />
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                <TextBlock Text="Machine: " Foreground="{StaticResource MutedText}" Width="80" />
                                                <TextBlock Text="{Binding MachineName}" Foreground="White" />
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                <TextBlock Text="OS: " Foreground="{StaticResource MutedText}" Width="80" />
                                                <TextBlock Text="{Binding OSDescription}" Foreground="White" TextTrimming="CharacterEllipsis" Width="300" />
                                            </StackPanel>
                                        </StackPanel>

                                        <StackPanel Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Top">
                                            <TextBlock Text="App" Foreground="White" FontWeight="SemiBold" />
                                            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                <TextBlock Text="Memory:" Foreground="{StaticResource MutedText}" Width="80" />
                                                <TextBlock Text="{Binding AppMemoryMb, StringFormat={}{0} MB}" Foreground="White" />
                                            </StackPanel>
                                            <Button Content="Refresh Weather" Width="160" Height="28" Margin="0,8,0,0" Command="{Binding RefreshWeatherCommand}" Background="{StaticResource ElectricBlue}" Foreground="White" BorderThickness="0" />
                                        </StackPanel>
                                    </Grid>
                                </Border>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                    <Border Background="#0F0F10" Padding="8" CornerRadius="6" Margin="0,0,8,0">
                                        <StackPanel>
                                            <TextBlock Text="Upcoming" Foreground="{StaticResource MutedText}" />
                                            <TextBlock Text="{Binding UpcomingEvents.Count}" Foreground="White" FontSize="16" FontWeight="Bold" />
                                        </StackPanel>
                                    </Border>

                                    <Border Background="#0F0F10" Padding="8" CornerRadius="6" Margin="0,0,8,0">
                                        <StackPanel>
                                            <TextBlock Text="Todos" Foreground="{StaticResource MutedText}" />
                                            <TextBlock Text="{Binding ToDoItems.Count}" Foreground="White" FontSize="16" FontWeight="Bold" />
                                        </StackPanel>
                                    </Border>

                                    <Border Background="#0F0F10" Padding="8" CornerRadius="6">
                                        <StackPanel>
                                            <TextBlock Text="Events" Foreground="{StaticResource MutedText}" />
                                            <TextBlock Text="{Binding CalendarEvents.Count}" Foreground="White" FontSize="16" FontWeight="Bold" />
                                        </StackPanel>
                                    </Border>
                                </StackPanel>

                                <TextBlock Text="Next events" Foreground="White" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,6" />
                                <ListBox ItemsSource="{Binding UpcomingEvents}" Background="Transparent" BorderThickness="0">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Border Padding="8" Margin="4" Background="#0F0F10" CornerRadius="6" BorderBrush="#222" BorderThickness="1">
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Date, StringFormat=d}" Foreground="{StaticResource MutedText}" FontSize="12" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Time}" Foreground="White" FontSize="13" FontWeight="SemiBold" />
                                                        <TextBlock Text=" - " Foreground="White" FontSize="13" FontWeight="SemiBold" />
                                                        <TextBlock Text="{Binding Title}" Foreground="White" FontSize="13" FontWeight="SemiBold" />
                                                    </StackPanel>
                                                    <TextBlock Text="{Binding Description}" Foreground="{StaticResource MutedText}" FontSize="12" />
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Calendar mode (default) -->
                    <Grid x:Name="CalendarModePanel" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,0,0,8" Grid.ColumnSpan="2">
                            <Button x:Name="ThreeMonthViewBtn" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="40" Height="28" Margin="0,0,8,0" ToolTip="3 Months">
                                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8A7;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Button>
                            <Button x:Name="MonthViewBtn" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="40" Height="28" Margin="0,0,8,0" Command="{Binding SetMonthViewCommand}" ToolTip="Month">
                                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE787;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Button>
                            <Button x:Name="WeekViewBtn" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="40" Height="28" Margin="0,0,8,0" Command="{Binding SetWeekViewCommand}" ToolTip="Week">
                                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE823;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Button>
                            <Button x:Name="DayViewBtn" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="40" Height="28" Command="{Binding SetDayViewCommand}" ToolTip="Day">
                                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8D1;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Button>
                        </StackPanel>

                        <!-- Split calendar area into two columns: calendar (left) and events (right) -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="1*" />
                                <ColumnDefinition Width="1*" />
                            </Grid.ColumnDefinitions>

                            <!-- Month view panel (default) with three stacked calendars -->
                            <Grid x:Name="MonthViewPanel" Grid.Column="0" Visibility="Collapsed">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel Orientation="Vertical">
                                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,12">
                                            <Calendar x:Name="Cal1" Style="{StaticResource LargeCalendarStyle}" Background="White" DisplayMode="Month" SelectedDate="{Binding SelectedDate, Mode=TwoWay}" DisplayDate="{Binding SelectedDateMonth1, Mode=OneWay}" />
                                        </Border>

                                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,12">
                                            <Calendar x:Name="Cal2" Style="{StaticResource LargeCalendarStyle}" Background="White" DisplayMode="Month" SelectedDate="{Binding SelectedDate, Mode=TwoWay}" DisplayDate="{Binding SelectedDateMonth2, Mode=OneWay}" />
                                        </Border>

                                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,12">
                                            <Calendar x:Name="Cal3" Style="{StaticResource LargeCalendarStyle}" Background="White" DisplayMode="Month" SelectedDate="{Binding SelectedDate, Mode=TwoWay}" DisplayDate="{Binding SelectedDateMonth3, Mode=OneWay}" />
                                        </Border>
                                    </StackPanel>
                                </ScrollViewer>
                            </Grid>

                            <!-- Single month view panel -->
                            <Grid x:Name="SingleMonthPanel" Grid.Column="0" Visibility="Visible">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel Orientation="Vertical">
                                        <Border Style="{StaticResource CardStyle}" Margin="0,0,0,12">
                                            <Calendar x:Name="SingleCal" Style="{StaticResource LargeCalendarStyle}" Background="White" DisplayMode="Month" SelectedDate="{Binding SelectedDate, Mode=TwoWay}" DisplayDate="{Binding SelectedDateMonth1, Mode=OneWay}" />
                                        </Border>
                                    </StackPanel>
                                </ScrollViewer>
                            </Grid>

                            <!-- Day view panel -->
                            <Grid x:Name="DayViewPanel" Grid.Column="0" Visibility="Collapsed">
                                <Border Style="{StaticResource CardStyle}" Margin="0,0,0,12">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Day Planner" Foreground="White" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8" />

                                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                            <ItemsControl x:Name="DaySlots">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border BorderBrush="#222" BorderThickness="0,0,0,1" Padding="6" MouseLeftButtonDown="DaySlot_MouseLeftButtonDown">
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding SlotText}" Width="80" Foreground="{StaticResource MutedText}" />
                                                                <TextBlock Text="{Binding EventText}" Foreground="White" />
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </Grid>
                                </Border>
                            </Grid>

                            <!-- Week view panel -->
                            <Grid x:Name="WeekViewPanel" Grid.Column="0" Visibility="Collapsed">
                                <Border Style="{StaticResource CardStyle}" Margin="0,0,0,12" Padding="6">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Week Planner" Foreground="White" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8" />

                                        <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto">
                                            <ItemsControl x:Name="WeekColumns">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Width="220" Margin="4" Background="#111" Padding="6" CornerRadius="6">
                                                            <StackPanel>
                                                                <TextBlock Text="{Binding DayHeader}" Foreground="White" FontWeight="SemiBold" />
                                                                <ItemsControl ItemsSource="{Binding Events}">
                                                                    <ItemsControl.ItemTemplate>
                                                                        <DataTemplate>
                                                                            <Border Padding="6" Margin="4" Background="#0F0F10" CornerRadius="6" BorderBrush="#222" BorderThickness="1" MouseLeftButtonDown="WeekEvent_MouseLeftButtonDown">
                                                                                <StackPanel>
                                                                                    <TextBlock Text="{Binding Time}" Foreground="{StaticResource MutedText}" FontSize="12" />
                                                                                    <TextBlock Text="{Binding Title}" Foreground="White" FontSize="13" FontWeight="SemiBold" />
                                                                                </StackPanel>
                                                                            </Border>
                                                                        </DataTemplate>
                                                                    </ItemsControl.ItemTemplate>
                                                                </ItemsControl>
                                                            </StackPanel>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </Grid>
                                </Border>
                            </Grid>

                            <!-- Events column (right half) with icon buttons -->
                            <Border x:Name="AgendaPanel" Grid.Column="1" Style="{StaticResource CardStyle}" Margin="12,0,0,0">
                                <StackPanel>
                                    <TextBlock Text="Events" Foreground="White" FontSize="14" FontWeight="SemiBold" />
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,6,0,6">
                                        <Button x:Name="BtnAddEvent" Width="36" Height="28" Margin="2" ToolTip="Add Event" Background="{StaticResource ElectricBlue}" BorderThickness="0">
                                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE710;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                        </Button>
                                        <Button x:Name="BtnEditEvent" Width="36" Height="28" Margin="2" ToolTip="Edit Event">
                                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE70F;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                        </Button>
                                        <Button x:Name="BtnDeleteEvent" Width="36" Height="28" Margin="2" ToolTip="Delete Event" Background="{StaticResource VibrantOrange}" BorderThickness="0">
                                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE74D;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                        </Button>
                                    </StackPanel>
                                    <ListBox x:Name="LbEvents" ItemsSource="{Binding SelectedDateEvents}" Foreground="White" Background="Transparent" BorderThickness="0" DisplayMemberPath="Title">
                                    </ListBox>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>

                    <!-- Tasks mode -->
                    <Border x:Name="TasksModePanel" Visibility="Collapsed" Style="{StaticResource CardStyle}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <TextBox Width="300" Height="32" Margin="0,0,8,0" Text="{Binding NewTodoText, UpdateSourceTrigger=PropertyChanged}" mah:TextBoxHelper.Watermark="Add a task..." />
                                <Button Content="Add" Width="80" Height="32" Command="{Binding AddTodoCommand}" Background="{StaticResource ElectricBlue}" Foreground="White" BorderThickness="0" />
                            </StackPanel>

                            <ListBox Grid.Row="1" ItemsSource="{Binding ToDoItems}" Background="Transparent" BorderThickness="0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Padding="10" Margin="6" Background="#0F0F10" CornerRadius="6" BorderBrush="#222" BorderThickness="1">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Text}" Foreground="White" FontSize="14" />
                                                <TextBlock Text="{Binding Timestamp}" Foreground="{StaticResource MutedText}" FontSize="12" />
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                    </Border>

                    <!-- Clipboard mode -->
                    <Border x:Name="ClipboardModePanel" Visibility="Collapsed" Style="{StaticResource CardStyle}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,8">
                                <Button Content="Clear All" Width="100" Height="28" Command="{Binding ClearClipboardCommand}" Background="{StaticResource VibrantOrange}" Foreground="White" BorderThickness="0" />
                            </StackPanel>

                            <ListBox Grid.Row="1" ItemsSource="{Binding ClipboardItems}" Background="Transparent" BorderThickness="0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Padding="10" Margin="6" Background="#0F0F10" CornerRadius="6" BorderBrush="#222" BorderThickness="1">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Text}" Foreground="White" FontSize="14" TextWrapping="Wrap" />
                                                    <TextBlock Text="{Binding Timestamp}" Foreground="{StaticResource MutedText}" FontSize="12" />
                                                </StackPanel>

                                                <Button Grid.Column="1" Width="28" Height="28" Margin="8,0,0,0" ToolTip="Delete clip"
                                                        Command="{Binding DataContext.RemoveClipboardItemCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                        CommandParameter="{Binding}">
                                                    <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE74D;" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                                                </Button>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Grid>
                    </Border>

                    <!-- Notepad mode -->
                    <Border x:Name="NotepadModePanel" Visibility="Collapsed" Style="{StaticResource CardStyle}">
                        <views:NotepadView />
                    </Border>

                    <!-- File search mode -->
                    <Border x:Name="SearchModePanel" Visibility="Collapsed" Style="{StaticResource CardStyle}">
                        <views:FileSearchView />
                    </Border>

                    <!-- Settings mode -->
                    <Grid x:Name="SettingsModePanel" Visibility="Collapsed">
                        <Border Style="{StaticResource CardStyle}">
                            <StackPanel>
                                <TextBlock Text="Settings" Foreground="White" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,8" />

                                <StackPanel Orientation="Horizontal" Margin="0,6,0,6">
                                    <TextBlock Text="Theme:" Foreground="{StaticResource MutedText}" Width="120" VerticalAlignment="Center" />
                                    <ComboBox Width="200" SelectedValue="{Binding Theme, Mode=TwoWay}">
                                        <ComboBoxItem Content="Dark" />
                                        <ComboBoxItem Content="Light" />
                                        <ComboBoxItem Content="Electric Blue" />
                                        <ComboBoxItem Content="Vibrant Orange" />
                                    </ComboBox>
                                </StackPanel>

                                <!-- Color Palette Preview -->
                                <Border Background="{StaticResource DarkGray}" CornerRadius="6" Padding="12" Margin="0,12,0,12">
                                    <StackPanel>
                                        <TextBlock Text="New Color Palette" Foreground="White" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8" />
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,4,0,4">
                                            <Border Background="{StaticResource ElectricBlue}" Width="40" Height="40" CornerRadius="4" Margin="0,0,8,0" />
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Electric Blue" Foreground="White" FontSize="12" />
                                                <TextBlock Text="#007BFF - Primary" Foreground="{StaticResource MutedText}" FontSize="10" />
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,4,0,4">
                                            <Border Background="{StaticResource VibrantOrange}" Width="40" Height="40" CornerRadius="4" Margin="0,0,8,0" />
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Vibrant Orange" Foreground="White" FontSize="12" />
                                                <TextBlock Text="#FF6F00 - Accent" Foreground="{StaticResource MutedText}" FontSize="10" />
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,4,0,4">
                                            <Border Background="{StaticResource DarkGray}" Width="40" Height="40" CornerRadius="4" Margin="0,0,8,0" BorderBrush="White" BorderThickness="1" />
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Dark Gray" Foreground="White" FontSize="12" />
                                                <TextBlock Text="#333333 - Text/BG" Foreground="{StaticResource MutedText}" FontSize="10" />
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,4,0,4">
                                            <Border Background="{StaticResource LightGray}" Width="40" Height="40" CornerRadius="4" Margin="0,0,8,0" BorderBrush="{StaticResource DarkGray}" BorderThickness="1" />
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="Light Gray" Foreground="White" FontSize="12" />
                                                <TextBlock Text="#F5F5F5 - Neutral BG" Foreground="{StaticResource MutedText}" FontSize="10" />
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,4,0,4">
                                            <Border Background="{StaticResource White}" Width="40" Height="40" CornerRadius="4" Margin="0,0,8,0" BorderBrush="{StaticResource DarkGray}" BorderThickness="1" />
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="White" Foreground="White" FontSize="12" />
                                                <TextBlock Text="#FFFFFF - Contrast" Foreground="{StaticResource MutedText}" FontSize="10" />
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <StackPanel Orientation="Horizontal" Margin="0,6,0,6">
                                    <TextBlock Text="Default View:" Foreground="{StaticResource MutedText}" Width="120" VerticalAlignment="Center" />
                                    <ComboBox Width="200" SelectedValue="{Binding DefaultView, Mode=TwoWay}">
                                        <ComboBoxItem Content="Month" />
                                        <ComboBoxItem Content="Week" />
                                        <ComboBoxItem Content="Day" />
                                    </ComboBox>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="0,6,0,6">
                                    <TextBlock Text="Start on Calendar:" Foreground="{StaticResource MutedText}" Width="120" VerticalAlignment="Center" />
                                    <CheckBox IsChecked="{Binding StartOnCalendar, Mode=TwoWay}" Foreground="White" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" Margin="0,6,0,6">
                                    <TextBlock Text="Use 24-hour time:" Foreground="{StaticResource MutedText}" Width="120" VerticalAlignment="Center" />
                                    <CheckBox IsChecked="{Binding Use24Hour, Mode=TwoWay}" Foreground="White" />
                                </StackPanel>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,12,0,0">
                                    <Button Content="Save Settings" Width="120" Height="32" Command="{Binding SaveSettingsCommand}" Background="{StaticResource ElectricBlue}" Foreground="White" BorderThickness="0" />
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </Grid>

                </Grid>

                <!-- Right card (agenda) - always visible -->
                <Border Grid.Column="1" Style="{StaticResource CardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <TextBlock Text="Agenda" Foreground="White" FontSize="16" FontWeight="SemiBold" />

                        <!-- Add todo input in agenda -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,12">
                            <TextBox Width="200" Height="30" Text="{Binding NewTodoText, UpdateSourceTrigger=PropertyChanged}" mah:TextBoxHelper.Watermark="Add a custom todo..." />
                            <Button Content="Add" Width="80" Height="30" Margin="8,0,0,0" Command="{Binding AddTodoCommand}" Background="{StaticResource ElectricBlue}" Foreground="White" BorderThickness="0" />
                        </StackPanel>

                        <StackPanel Grid.Row="2" VerticalAlignment="Top">
                            <TextBlock Text="Today's items" Foreground="{StaticResource MutedText}" Margin="0,0,0,8" />
                            <ListBox ItemsSource="{Binding ToDoItems}" Background="Transparent" BorderThickness="0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Padding="8" Margin="4" Background="#0F0F10" CornerRadius="6" BorderBrush="#222" BorderThickness="1">
                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Text}" Foreground="White" FontSize="13" />
                                                    <TextBlock Text="{Binding Timestamp}" Foreground="{StaticResource MutedText}" FontSize="11" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
            <Image Source="/SwiftOpsToolboxLogo.png" Width="509" Height="101" HorizontalAlignment="Left" Margin="2,0,0,0" VerticalAlignment="Center" />
        </Grid>
    </Grid>

</mah:MetroWindow>
